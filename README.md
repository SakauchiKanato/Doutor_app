# ドトール発注管理アプリ

海浜幕張駅ナカのドトールコーヒーショップ向け発注管理Webアプリケーション

## 🎯 主な機能

### 1. 発注計算（メイン機能）
- **3日間のリードタイム対応**: 発注から納品までの3日間を考慮した計算
- **星ランク予測**: ⭐️1〜5で混み具合を予測し、自動計算
- **詳細な計算内訳**: なぜその数になったかを透明化
- **安全バッファ**: 不安な場合は追加で上乗せ可能

### 2. 商品マスタ管理
- 商品の登録・編集・削除
- 星ランク別消費量の設定（⭐️1〜5それぞれ）
- 安全在庫数の設定

### 3. イベントカレンダー
- 幕張メッセ・ZOZOマリンのイベント管理
- 推奨星ランクの設定
- 外部サイトへのリンク

### 4. 実績フィードバック
- 予測と実績の差分記録
- 精度向上のためのデータ蓄積
- 差分の可視化

## 🚀 セットアップ方法

### 必要な環境
- PHP 7.4以上
- SQLite3
- Webブラウザ（Chrome, Safari, Firefoxなど）

### インストール手順

1. **データベースの初期化**
   ```bash
   cd /Users/sakauchikanato/ishibashiken/asobi/hattyuu_app
   sqlite3 db/doutor.db < db/init.sql
   ```

2. **PHPサーバーの起動**
   ```bash
   php -S localhost:8000
   ```

3. **ブラウザでアクセス**
   ```
   http://localhost:8000
   ```

### デフォルトログイン情報
- **ユーザー名**: `admin`
- **パスワード**: `admin123`

## 📱 使い方

### 基本的な流れ

1. **ログイン**
   - デフォルトのユーザー名とパスワードでログイン

2. **商品登録**
   - 「商品管理」から発注したい商品を登録
   - 星ランク別の消費量を設定（⭐️1〜5）

3. **イベント確認**
   - 「イベント」で幕張メッセやZOZOマリンのイベントを確認
   - 推奨星ランクを参考にする

4. **発注計算**
   - 「発注計算」で商品を選択
   - 現在の在庫数を入力
   - 今日〜3日後の星ランクを選択
   - 計算結果をドトール端末に手入力

5. **実績入力**
   - 営業終了後、「実績入力」で実際の消費量を記録
   - 予測精度が向上

## ⭐️ 星ランクの目安

- **⭐️ (星1)**: 平日の閑散期
- **⭐️⭐️ (星2)**: 通常の平日
- **⭐️⭐️⭐️ (星3)**: 週末や小規模イベント
- **⭐️⭐️⭐️⭐️ (星4)**: 中規模イベント（幕張メッセ展示会など）
- **⭐️⭐️⭐️⭐️⭐️ (星5)**: 大規模イベント（コンサート、スタジアム満員など）

## 📊 発注計算の仕組み

```
発注量 = 安全在庫数 - 現在在庫数 + 3日間の消費量 + 安全バッファ
```

- **安全在庫数**: 最低限キープしたい在庫量
- **現在在庫数**: 今ある在庫
- **3日間の消費量**: 今日・明日・明後日の星ランクから計算
- **安全バッファ**: 念のため追加する量（オプション）

## 🗂️ ファイル構成

```
hattyuu_app/
├── index.php              # ダッシュボード
├── login.php              # ログイン画面
├── logout.php             # ログアウト処理
├── auth.php               # 認証チェック
├── config.php             # DB接続設定
├── order_calculator.php   # 発注計算
├── items.php              # 商品一覧
├── item_edit.php          # 商品編集
├── calendar.php           # イベントカレンダー
├── event_edit.php         # イベント編集
├── feedback.php           # 実績入力
├── css/
│   └── style.css          # スタイルシート
├── js/
│   └── app.js             # JavaScript
├── db/
│   ├── init.sql           # DB初期化スクリプト
│   └── doutor.db          # SQLiteデータベース
└── includes/
    ├── header.php         # 共通ヘッダー
    └── footer.php         # 共通フッター
```

## 🔒 セキュリティ

- **SQLインジェクション対策**: PDOプリペアドステートメント使用
- **XSS対策**: `htmlspecialchars()`で出力エスケープ
- **パスワード**: `password_hash()`でハッシュ化
- **セッション管理**: セッションIDの再生成

## 📝 注意事項

### 重要
- このアプリはドトール公式システムとは独立して動作します
- 計算結果は必ず公式端末に手入力する必要があります
- 発注から納品まで3日間かかります

### ゼミサーバーでの運用
- 卒業後のアクセス権を事前に確認してください
- 外部公開する場合は、セキュリティ設定を強化してください
- 定期的なバックアップを推奨します

## 🔧 カスタマイズ

### パスワード変更
```php
// config.phpで新しいハッシュを生成
echo password_hash('新しいパスワード', PASSWORD_DEFAULT);
```

### 星ランク定義の調整
- 「商品管理」→「編集」から各商品の星ランク別消費量を調整できます
- 実績データを元に、徐々に精度を上げていきましょう

## 🌟 今後の拡張案

- [ ] 過去データ分析機能
- [ ] 機械学習による自動予測
- [ ] 在庫アラート通知
- [ ] バーコードスキャン機能
- [ ] 複数店舗対応

## 📞 サポート

質問や不具合がある場合は、開発者に連絡してください。

---

**開発**: 2026年1月  
**バージョン**: 1.0.0  
**ライセンス**: MIT
